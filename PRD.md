# Product Requirements Document – PTDetailing

## 1. Executive Summary
PTDetailing is a pyRevit extension that imports post-tension tendon data from **INDUCTA PTD** into Autodesk Revit®, automating detailing tasks such as drawing, renumbering and tagging tendons with consistent Revit families. The goal is to replace the current prototype with a production-ready, user-friendly add-in that enhances productivity and drawing quality for structural engineers and drafters working on post-tensioned concrete slabs.

---

## 2. Problem Statement
Manual transfer of tendon information from PTD to Revit is time-consuming, error-prone and yields inconsistent documentation. The existing prototype works but lacks:
1. Robust modular code architecture and tests.
2. Professional UI/UX (only basic pyRevit buttons; no dialogs, error feedback, progress bars).
3. Standardised Revit families, causing users to accidentally load/place incorrect families.
4. Installation & developer tooling (Task-Master, CI, packaging) for maintainability.

---

## 3. Goals & Objectives
MVP goals (Revit 2024):
• One-click tendon import from PTD export file.  
• Automatic placement of tendon detail components with correct family/symbol.  
• Tools to renumber tendons (by order / by spline) and update tags.  
• Auto-generated tags showing live/dead ends & high/low points.  
• Guided UI (file picker, progress dialog, error list).  
• Bundled standard families & automatic family loader.  
• Task-Master based dev workflow, tests & linting pipeline.  
• Comprehensive documentation (README, PRD, CONTRIBUTING).  

Stretch goals: GUI profile preview, native Revit Tendon elements, CI/CD release pipeline.

---

## 4. User Personas
1. **Structural Drafter** – Needs to quickly bring PTD output into Revit and produce shop drawings.  
2. **Structural Engineer** – Reviews tendon layout inside Revit for coordination.  
3. **BIM Manager** – Manages company standards, installs add-ins, checks family compliance.  
4. **Developer / Contributor** – Extends functionality, fixes bugs, maintains codebase.

---

## 5. Key Use Cases & User Stories
• *As a drafter* I select the PTD export file and PTDetailing draws all tendons on the active view.  
• *As a drafter* I need to renumber tendons in a chosen sequence so the drawing matches the shop schedule.  
• *As a drafter* I tag selected tendons and the tag displays live/dead ends + elevations automatically.  
• *As a BIM manager* I ensure the extension uses our standard tendon family without manual reloading.  
• *As a developer* I can run `task test` to verify changes without opening Revit.

---

## 6. Functional Requirements
### 6.1 Import Tendons
FR-01 Parse `PTD_Export.txt` generated by PTD.  
FR-02 Support unit/delimiter variations (configurable).  
FR-03 Map PTD tendon properties to Revit detail component parameters.  
FR-04 Place detail components at correct coordinates in plan view.  
FR-05 Store metadata on each element for future edits.  
FR-06 Auto-align import: determine optimal rotation & translation so the tendon set fits within the slab outline; if fit exceeds tolerance prompt user for placement.

### 6.2 Renumber Tendons
FR-07 Update element parameter `Mark` and any tag label.  
FR-08 Offer preview and undo support.

### 6.3 Tagging
FR-09 Tag selected or all tendons with configured tag family.  
FR-10 Tag displays live/dead end symbols plus high/low profile text.  
FR-11 Tags update dynamically if tendon data changes.

### 6.4 User Interface
FR-12 pyRevit ribbon group _Post Tensioning_ with Import, Renumber, Tag tools.  
FR-13 File open dialog for import, progress bar during creation.  
FR-14 Error/Warning panel listing skipped items or family mismatches.  
FR-15 Settings dialog (units, default families, naming conventions).

### 6.5 Standard Families
FR-16 Bundle `.rfa` files (tendon detail, tags, symbols) inside extension.  
FR-17 Auto-load missing families into project on demand.  
FR-18 Validate family version (Revit 2024) and category.

### 6.6 Developer Tooling
FR-19 Task-Master tasks for lint, format, test, bundle.  
FR-20 Unit tests using `pytest` + `revit-stubs`.  
FR-21 GitHub Actions workflow running Task-Master tasks.  
FR-22 Versioning via `git tag` + changelog.

---

## 7. Non-Functional Requirements
• Performance: Import 500 tendons in < 30 seconds on mid-spec workstation.  
• Reliability: Error handling with informative messages; no silent failures.  
• Compatibility: Revit 2024+; pyRevit 4.8.16; IronPython 2.7.11.  
• Usability: Minimal clicks; consistent with Revit UI patterns; supports dark/light mode.  
• Maintainability: Modular code; >80% unit test coverage for core library; PEP8 compliant.  
• Extensibility: Clear API layer so future ports to CPython or native add-in are possible.

---

## 8. Assumptions
• Users already own PTD and Revit licences.  
• PTD export file structure remains stable (changes will trigger minor version update).  
• Users have permissions to install pyRevit add-ins.

---

## 9. Out of Scope
• Finite-element calculations or verification of PTD results.  
• Editing tendon geometry after import (beyond renumbering).  
• Support for Revit versions earlier than 2022.  
• MacOS.

---

## 10. Success Metrics
• 80% reduction in manual drafting time compared to current workflow.  
• <2% manual adjustments required per drawing set.  
• Zero critical bugs after 4 weeks in production.  
• 100% of beta testers report "easy" or "very easy" installation.

---

## 11. Risks & Mitigations
| Risk | Impact | Likelihood | Mitigation |
|------|--------|-----------|------------|
| PTD format change | High | Low | Abstract file parser; add sample files to tests |
| Revit API breaking change | High | Medium | Target LTS versions; CI against Revit 2025 stubs |
| IronPython limitations | Medium | Medium | Keep heavy logic outside Revit context; plan CPython port |
| Missing families | Medium | High | Bundle families & auto-loader |
| Performance bottlenecks | Medium | Medium | Batch element creation; minimise API calls |

---

## 12. Timeline & Milestones (T-0 = project kick-off)
| Milestone | Date | Notes |
|-----------|------|-------|
| M1 – Architecture & PRD sign-off | T-0 + 1 wk |
| M2 – Core import library (tested) | T-0 + 3 wks |
| M3 – UI commands & family loader | T-0 + 5 wks |
| M4 – Tagging + renumber tools | T-0 + 6 wks |
| M5 – Beta release & user feedback | T-0 + 8 wks |
| M6 – Stretch goals & polish | T-0 + 10 wks |

---

## 13. Stakeholders & Roles
• **Product Owner** – Defines requirements, prioritises backlog.  
• **Lead Developer** – Overall architecture, code review.  
• **UI/UX Designer** – Dialog layouts, icons.  
• **QA Engineer** – Test plans, regression testing.  
• **Beta Users** – Provide real-world feedback (drafters, engineers).

---

## 14. Acceptance Criteria (MVP)
1. Import command reads PTD file and creates matching number of tendons in Revit.  
2. Import completes without unhandled exceptions; error list provided if any tendon skipped.  
3. Renumber commands correctly update `Mark` parameter according to selected mode.  
4. Tag command places chosen tag family and displays correct data.  
5. Extension installs by copying folder into pyRevit extensions dir with no extra steps.  
6. Task-Master tasks `lint`, `test`, `bundle` run successfully on a clean clone.

---

**Last updated:** {{DATE}} 